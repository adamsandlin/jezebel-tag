<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Found Jezebel?</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f4f4f9; color: #333; padding: 20px; text-align: center; }
        .card { background: white; max-width: 400px; margin: 0 auto; padding: 20px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.1); }
        img.profile { width: 200px; height: 200px; object-fit: cover; border-radius: 50%; border: 4px solid #4CAF50; margin-bottom: 15px; }
        h1 { margin: 10px 0; font-size: 24px; }
        p { margin: 5px 0; font-size: 16px; line-height: 1.5; }
        .details { text-align: left; margin-top: 20px; background: #fafafa; padding: 15px; border-radius: 10px; }
        .btn-group { margin-top: 20px; display: flex; flex-direction: column; gap: 10px; }
        
        /* Base Button Style */
        .btn { display: block; padding: 12px; border-radius: 8px; text-decoration: none; font-weight: bold; color: white; border: none; cursor: pointer; font-size: 16px; width: 100%; box-sizing: border-box; }

        /* Specific Button Colors */
        .btn-wa-adam { background-color: #25D366; }
        .btn-call-adam { background-color: #1B8F4B; }
        .btn-wa-alex { background-color: #007AFF; }
        .btn-call-alex { background-color: #0051A8; }

        .hidden { display: none; }
    </style>
</head>
<body>

<div class="card">
    <img src="jezebel.jpg" alt="Jezebel" class="profile">
    
    <h1 id="greeting">Hi, I'm Jezebel!</h1>
    <p id="intro">If you are reading this, I might be lost. Please help me get home!</p>

    <div class="details">
        <p><strong>ğŸ¶ Name:</strong> Jezebel</p>
        <p><strong>ğŸšº Sex:</strong> <span id="sex">Female</span></p>
        <p><strong>ğŸ• Breed:</strong> Australian Cattle Dog Mix</p>
        <p><strong>ğŸ‚ Age:</strong> <span id="age">Calculating...</span></p>
        <p><strong>âš–ï¸ Weight:</strong> 13 kg</p>
        <p><strong>ğŸ¥ Spayed:</strong> <span id="spayed">Yes</span></p>
        <p><strong>ğŸ’‰ Vaccinated:</strong> <span id="vax">Yes</span></p>
        <p><strong>ğŸ›œ Microchipped:</strong> <span id="chip">Yes</span></p>
        <p><strong>ğŸ©º Allergies:</strong> <span id="allergies">Chicken</span></p>
        <p><strong>ğŸ˜‡ Temperament:</strong> <span id="temp">Friendly, anxious with traffic</span></p>
        <p><strong>ğŸ  Home:</strong> Barcelona</p>
        <p><strong>ğŸ‘¨ğŸ»â€ğŸ¤â€ğŸ‘¨ğŸ¾ Parents:</strong> Adam & Alex</p>
    </div>

    <div class="btn-group">
        <button onclick="handleWhatsApp('Adam', '34607067359')" class="btn btn-wa-adam">ğŸ’¬ WhatsApp Adam</button>
        <a href="tel:+34607067359" class="btn btn-call-adam">ğŸ“ Call Adam ğŸ‡ªğŸ‡¸</a>
        <button onclick="handleWhatsApp('Alex', '16193012756')" class="btn btn-wa-alex">ğŸ’¬ WhatsApp Alex</button>
        <a href="tel:+16193012756" class="btn btn-call-alex">ğŸ“ Call Alex ğŸ‡ºğŸ‡¸</a>
    </div>
</div>

<script>
    // --- 1. CONFIGURATION ---
    const workerUrl = "https://jezebel-logger.adam-sandlin.workers.dev"; 
    
    const content = {
        en: {
            greeting: "Hi, I'm Jezebel!",
            intro: "If you are reading this, I might be lost. Please help me get home!",
            sex: "Female", spayed: "Yes", vax: "Yes", chip: "Yes", 
            allergies: "Chicken", temp: "Very friendly, anxious with traffic/noise",
            msg: "Adam & Alex, I found Jezebel and I think she may be lost."
        },
        es: {
            greeting: "Â¡Hola, soy Jezebel!",
            intro: "Si estÃ¡s leyendo esto, puede que estÃ© perdido. Â¡AyÃºdame a llegar a casa, por favor!",
            sex: "Hembra", spayed: "SÃ­", vax: "SÃ­", chip: "SÃ­", 
            allergies: "Pollo", temp: "Muy amigable, ansiosa con trÃ¡fico/ruido",
            msg: "Adam y Alex, encontrÃ© a Jezebel y creo que estÃ¡ perdida."
        }
    };

    // --- 2. LOGIC: LANGUAGE & AGE ---
    const userLang = navigator.language.startsWith('es') ? 'es' : 'en';
    const txt = content[userLang];

    // Apply text
    document.getElementById('greeting').innerText = txt.greeting;
    document.getElementById('intro').innerText = txt.intro;
    document.getElementById('sex').innerText = txt.sex;
    document.getElementById('spayed').innerText = txt.spayed;
    document.getElementById('vax').innerText = txt.vax;
    document.getElementById('chip').innerText = txt.chip;
    document.getElementById('allergies').innerText = txt.allergies;
    document.getElementById('temp').innerText = txt.temp;

    // Calculate Age
    const birthDate = new Date('2023-11-01');
    const now = new Date();
    const diffYears = (now - birthDate) / (1000 * 60 * 60 * 24 * 365.25);
    const roundedAge = Math.round(diffYears * 2) / 2; 
    document.getElementById('age').innerText = roundedAge + " Years";

    // --- 3. LOGIC: LOGGING (Quietly in background) ---
    if(workerUrl !== "https://jezebel-logger.adam-sandlin.workers.dev/") {
        fetch(workerUrl, {
            method: 'POST',
            keepalive: true,
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                userAgent: navigator.userAgent,
                language: navigator.language,
                timestamp: new Date().toISOString()
            })
        }).catch(e => console.log("Logging failed", e));
    }

    // --- 4. LOGIC: WHATSAPP & LOCATION (High Accuracy) ---
    function handleWhatsApp(name, phone) {
        const locationOptions = {
            enableHighAccuracy: true, 
            timeout: 10000,           
            maximumAge: 0             
        };

        if ("geolocation" in navigator) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    const lat = position.coords.latitude;
                    const long = position.coords.longitude;
                    const mapLink = `https://www.google.com/maps?q=${lat},${long}`;
                    sendWa(name, phone, mapLink);
                },
                (error) => {
                    console.warn("Location failed:", error);
                    sendWa(name, phone, null);
                },
                locationOptions
            );
        } else {
            sendWa(name, phone, null);
        }
    }

    function sendWa(name, phone, mapLink) {
        let finalMsg = "";
        
        if (userLang !== 'en') finalMsg += content[userLang].msg + "\n\n";
        finalMsg += content['en'].msg + "\n";
        
        if (mapLink) {
            finalMsg += `Location: ${mapLink}\n`;
        }
        
        finalMsg += `Time: ${new Date().toLocaleString()}\n`;
        finalMsg += "(Please add any details to help us locate her. Thank you!)";

        const url = `https://wa.me/${phone}?text=${encodeURIComponent(finalMsg)}`;
        
        // Arc/Safari safe redirect
        window.location.href = url;
    }
</script>

</body>
</html>
